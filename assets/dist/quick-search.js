!function(e){"function"==typeof define&&define.amd?define("quickSearch",e):e()}(function(){"use strict";window.render_quick_search=()=>{Array.from(document.querySelectorAll(".quick-search")).forEach(e=>{var t;e.__vue_app__||((t=(e=>{let t=JSON.parse(e.closest(".elementor-widget-container").querySelector(".vxconfig").innerHTML);return Vue.createApp({el:e,mixins:[Voxel.mixins.base],data(){return{postTypes:t.post_types,activePopup:null,activeType:Object.values(t.post_types)[0],search:"",loading:!1,recent:this.getRecent()}},created(){document.onkeydown=e=>{(e.ctrlKey||e.metaKey)&&75===e.keyCode&&(e.preventDefault(),this.activePopup=null===this.activePopup?"quick-search":null),27===e.keyCode&&(this.activePopup=null)}},methods:{viewArchive(){var e=new URL(this.activeType.archive);e.searchParams.set(this.activeType.filter,this.search),location.href=e.toString()},getResults(){this.search.trim().length<=2?(this.activeType.results.query="",this.activeType.results.items=[]):this.search.trim()!==this.activeType.results.query.trim()&&(this.loading=!0,this.activeType.results.query=this.search.trim(),jQuery.get(Voxel_Config.ajax_url+"&action=quick_search",{post_type:this.activeType.key,search:this.search.trim(),filter_key:this.activeType.filter,taxonomies:this.activeType.taxonomies.join(",")}).always(e=>{this.loading=!1,e.success?this.activeType.results.items=e.data:Voxel.alert(e.message||Voxel_Config.l10n.ajaxError,"error")}))},debouncedResults:Voxel.helpers.debounce(e=>e.getResults(),200),saveSearchItem(t){let e=this.getRecent();(e=e.filter(e=>e.key!==t.key)).unshift(t),e=e.slice(0,8),localStorage.setItem("voxel:recent_searches",JSON.stringify(e)),this.recent=e},saveCurrentTerm(){let e=this.getRecent();var t=this.search.trim();let r="keywords:"+t;var s=new URL(this.activeType.archive);s.searchParams.set(this.activeType.filter,t),(e=e.filter(e=>e.key!==r)).unshift({type:"keywords",key:r,title:t,logo:null,link:s.toString()}),e=e.slice(0,8),localStorage.setItem("voxel:recent_searches",JSON.stringify(e)),this.recent=e},clearRecents(){localStorage.setItem("voxel:recent_searches",JSON.stringify([])),this.recent=[]},clickedRecent(t){let e=this.getRecent();(e=e.filter(e=>e.key!==t.key)).unshift(t),localStorage.setItem("voxel:recent_searches",JSON.stringify(e))},getRecent(){let e=[];try{var t=JSON.parse(localStorage.getItem("voxel:recent_searches"));Array.isArray(t)&&(e=t)}catch(e){}return e}},watch:{search(){this.debouncedResults(this)}}})})(e)).component("form-group",Voxel.components.formGroup),t.mount(e))})},window.render_quick_search(),jQuery(document).on("voxel:markup-update",window.render_quick_search)});
