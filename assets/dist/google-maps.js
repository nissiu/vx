!function(e){"function"==typeof define&&define.amd?define("googleMaps",e):e()}(function(){"use strict";Voxel.Maps.Autocomplete=function(e,t,o={}){this.init(e,t,o)},Voxel.Maps.Bounds=function(e,t){this.southwest=e,this.northeast=t,this.init(e,t)},Voxel.Maps.Bounds.prototype.extend=function(e){},Voxel.Maps.Bounds.prototype.empty=function(){},Voxel.Maps.Bounds.prototype.getSourceObject=function(){},Voxel.Maps.Bounds.prototype.getSouthWest=function(){return this.southwest},Voxel.Maps.Bounds.prototype.getNorthEast=function(){return this.northeast},Voxel.Maps.Geocoder=function(){this.init()},Voxel.Maps.getGeocoder=function(){return Voxel.Maps._geocoder||(Voxel.Maps._geocoder=new Voxel.Maps.Geocoder),Voxel.Maps._geocoder},Voxel.Maps.Geocoder.prototype.geocode=function(e,t,o){},Voxel.Maps.Geocoder.prototype.formatFeature=function(e){},Voxel.Maps.Geocoder.prototype.getUserLocation=function({fetchAddress:t=!0,receivedPosition:o=e=>{},receivedAddress:n=e=>{},positionFail:e=()=>{},addressFail:s=()=>{}}={}){if(!navigator.geolocation)return e();navigator.geolocation.getCurrentPosition(e=>{e=new Voxel.Maps.LatLng(e.coords.latitude,e.coords.longitude);o(e),!1!==t&&Voxel.Maps.getGeocoder().geocode(e.toGeocoderFormat(),e=>e?n(e):(Voxel.alert(Voxel_Config.l10n.positionFail,"error"),s()))},()=>e())},Voxel.Maps.LatLng=function(e,t){this.init(e,t)},Voxel.Maps.LatLng.prototype.getLatitude=function(){},Voxel.Maps.LatLng.prototype.getLongitude=function(){},Voxel.Maps.LatLng.prototype.getSourceObject=function(){},Voxel.Maps.LatLng.prototype.toGeocoderFormat=function(){},Voxel.Maps.Map=function({el:e,zoom:t=10,center:o=new Voxel.Maps.LatLng(Voxel_Config.maps.default_lat,Voxel_Config.maps.default_lng),minZoom:n=4,maxZoom:s=16,draggable:p=!0}){this.init({el:e,zoom:t,center:o,minZoom:n,maxZoom:s,draggable:p})},Voxel.Maps.Map.prototype.setZoom=function(e){},Voxel.Maps.Map.prototype.getZoom=function(){},Voxel.Maps.Map.prototype.getMinZoom=function(){},Voxel.Maps.Map.prototype.getMaxZoom=function(){},Voxel.Maps.Map.prototype.setCenter=function(e){},Voxel.Maps.Map.prototype.getCenter=function(){},Voxel.Maps.Map.prototype.fitBounds=function(e){},Voxel.Maps.Map.prototype.panTo=function(e){},Voxel.Maps.Map.prototype.getClickPosition=function(e){},Voxel.Maps.Map.prototype.addListener=function(e,t){},Voxel.Maps.Map.prototype.addListenerOnce=function(e,t){},Voxel.Maps.Map.prototype.removeListener=function(e){},Voxel.Maps.Map.prototype.trigger=function(e){},Voxel.Maps.Map.prototype.mapEvent=function(e){return void 0!==this.eventMap[e]?this.eventMap[e]:e},Voxel.Maps.Map.prototype.removeMarkers=function(){for(var e=0;e<this.markers.length;e++)this.markers[e].remove();this.markers=[]},Voxel.Maps.Map.prototype.getSourceObject=function(){},Voxel.Maps.Marker=function({map:e=null,position:t=null,onClick:o=null,template:n=null}){this.template=n,this.init({map:e,position:t,onClick:o})},Voxel.Maps.Marker.prototype.getPosition=function(){},Voxel.Maps.Marker.prototype.setPosition=function(e){},Voxel.Maps.Marker.prototype.getMap=function(){},Voxel.Maps.Marker.prototype.setMap=function(e){},Voxel.Maps.Marker.prototype.remove=function(){},Voxel.Maps.Marker.prototype.addClass=function(){},Voxel.Maps.Marker.prototype.removeClass=function(){},Voxel.Maps.Marker.prototype.getTemplate=function(){var e=this.template||'<div class="map-marker marker-type-icon"><i class="las la-map-marker"></i></div>';return jQuery(`<div class="marker-wrapper">${e}</div>`)},Voxel.Maps.Popup=function({map:e=null,position:t=null,content:o=null}){this.init({map:e,position:t,content:o})},Voxel.Maps.Popup.prototype.init=function(e){},Voxel.Maps.Popup.prototype.setContent=function(e){},Voxel.Maps.Popup.prototype.setPosition=function(e){},Voxel.Maps.Popup.prototype.setMap=function(e){},Voxel.Maps.Popup.prototype.show=function(){},Voxel.Maps.Popup.prototype.hide=function(){},Voxel.Maps.Circle=function({map:e=null,center:t=null,radius:o=null,visible:n=null,className:s="map-circle"}){this.init({map:e,center:t,radius:o,visible:n,className:s})},Voxel.Maps.Autocomplete.prototype.init=function(e,t,o){!e instanceof Element||(this.el=e,this.input=jQuery(this.el),this.options={fields:["geometry.location","geometry.viewport","formatted_address"]},o.feature_types?.length&&(this.options.types=Vue.toRaw(o.feature_types)),o.countries?.length&&(this.options.componentRestrictions={country:Vue.toRaw(o.countries)}),this.autocomplete=new google.maps.places.Autocomplete(this.el,this.options),this.input.on("input",e=>{t()}),this.autocomplete.addListener("place_changed",()=>{var e=this.autocomplete.getPlace();e&&e.formatted_address&&t(Voxel.Maps.getGeocoder().formatFeature(e))}))},Voxel.Maps.Bounds.prototype.init=function(e,t){this.southwest=e,this.northeast=t,this.bounds=new google.maps.LatLngBounds(e?.getSourceObject(),t?.getSourceObject())},Voxel.Maps.Bounds.prototype.getSouthWest=function(){return this.southwest},Voxel.Maps.Bounds.prototype.getNorthEast=function(){return this.northeast},Voxel.Maps.Bounds.prototype.extend=function(e){this.bounds.extend(e.getSourceObject())},Voxel.Maps.Bounds.prototype.empty=function(){return this.bounds.isEmpty()},Voxel.Maps.Bounds.prototype.getSourceObject=function(){return this.bounds},Voxel.Maps.Geocoder.prototype.init=function(){this.geocoder=new google.maps.Geocoder},Voxel.Maps.Geocoder.prototype.geocode=function(e,o,n){var s=this,p=!1,t={};if(e instanceof google.maps.LatLng)t.location=e;else{if("string"!=typeof e||!e.length)return n(p);t.address=e}"function"==typeof o&&(n=o,o={});o=jQuery.extend({limit:1},o);this.geocoder.geocode(t,(e,t)=>("OK"===t&&e&&e.length?p=1===o.limit?s.formatFeature(e[0]):e.map(this.formatFeature):console.log("Geocoding failed. ["+t+"]"),n(p)))},Voxel.Maps.Geocoder.prototype.formatFeature=function({geometry:{location:e,viewport:t},formatted_address:o}){return{address:o,latlng:new Voxel.Maps.LatLng(e.lat(),e.lng()),viewport:new Voxel.Maps.Bounds(new Voxel.Maps.LatLng(t.getSouthWest().lat(),t.getSouthWest().lng()),new Voxel.Maps.LatLng(t.getNorthEast().lat(),t.getNorthEast().lng()))}},Voxel.Maps.LatLng.prototype.init=function(e,t){this.latlng=new google.maps.LatLng(e,t)},Voxel.Maps.LatLng.prototype.getLatitude=function(){return this.latlng.lat()},Voxel.Maps.LatLng.prototype.getLongitude=function(){return this.latlng.lng()},Voxel.Maps.LatLng.prototype.getSourceObject=function(){return this.latlng},Voxel.Maps.LatLng.prototype.toGeocoderFormat=function(){return this.latlng},Voxel.Maps.Map.prototype.init=function({el:e,zoom:t,center:o,minZoom:n,maxZoom:s,draggable:p}){this.eventMap={},this.map=new google.maps.Map(e,{zoom:t,minZoom:3<=n?n:3,maxZoom:s,draggable:p,navigationControl:!0,mapTypeControl:!1,streetViewControl:!1,zoomControl:!0,controlSize:32,gestureHandling:"greedy",styles:Voxel_Config.google_maps?.skin||[{featureType:"all",elementType:"labels.text",stylers:[{color:"#878787"}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f9f5ed"}]},{featureType:"road.highway",elementType:"all",stylers:[{color:"#f5f5f5"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#c9c9c9"}]},{featureType:"water",elementType:"all",stylers:[{color:"#aee0f4"}]}]}),this.setCenter(o),e.classList.add("ts-map-loaded")},Voxel.Maps.Map.prototype.setZoom=function(e){this.map.setZoom(e)},Voxel.Maps.Map.prototype.getZoom=function(){return this.map.getZoom()},Voxel.Maps.Map.prototype.getMinZoom=function(){return this.map.minZoom},Voxel.Maps.Map.prototype.getMaxZoom=function(){return this.map.maxZoom},Voxel.Maps.Map.prototype.setCenter=function(e){this.map.setCenter(e.getSourceObject())},Voxel.Maps.Map.prototype.getCenter=function(){return new Voxel.Maps.LatLng(this.map.center.lat(),this.map.center.lng())},Voxel.Maps.Map.prototype.getBounds=function(){var e=this.map.getBounds();return new Voxel.Maps.Bounds(new Voxel.Maps.LatLng(e.getSouthWest()),new Voxel.Maps.LatLng(e.getNorthEast()))},Voxel.Maps.Map.prototype.fitBounds=function(e){this.map.fitBounds(e.getSourceObject(),0)},Voxel.Maps.Map.prototype.panTo=function(e){this.map.panTo(e.getSourceObject())},Voxel.Maps.Map.prototype.getClickPosition=function(e){return new Voxel.Maps.LatLng(e.latLng.lat(),e.latLng.lng())},Voxel.Maps.Map.prototype.addListener=function(e,t){return google.maps.event.addListener(this.map,this.mapEvent(e),e=>t(e))},Voxel.Maps.Map.prototype.addListenerOnce=function(e,t){return google.maps.event.addListenerOnce(this.map,this.mapEvent(e),e=>t(e))},Voxel.Maps.Map.prototype.removeListener=function(e){console.log(e),google.maps.event.removeListener(e)},Voxel.Maps.Map.prototype.trigger=function(e){google.maps.event.trigger(this.map,this.mapEvent(e))},Voxel.Maps.Map.prototype.getSourceObject=function(){return this.map},Voxel.Maps.Marker.prototype.init=function({map:e,position:t,onClick:o}){this.marker=new Voxel.Maps.GoogleMapsOverlay(this),this.onClick=o,e&&this.setMap(e),t&&this.setPosition(t)},Voxel.Maps.Marker.prototype.getPosition=function(){return this.position},Voxel.Maps.Marker.prototype.setPosition=function(e){this.position=e,this.marker.setPosition(e?.getSourceObject())},Voxel.Maps.Marker.prototype.getMap=function(){return this.map},Voxel.Maps.Marker.prototype.setMap=function(e){this.map=e,this.marker.setMap(e.getSourceObject())},Voxel.Maps.Marker.prototype.remove=function(){return this.marker.setMap(null),this.marker.remove(),this},Voxel.Maps.Marker.prototype.getSourceObject=function(){return this.marker},Voxel.Maps.Marker.prototype.addClass=function(e){return this.marker.node?.classList.add(e)},Voxel.Maps.Marker.prototype.removeClass=function(e){return this.marker.node?.classList.remove(e)},Voxel.Maps.SetupMarkerOverlay=()=>{Voxel.Maps.GoogleMapsOverlay=function(e){this.marker=e,this.template=e.getTemplate(),this.latlng=e.getPosition()?.getSourceObject()},Voxel.Maps.GoogleMapsOverlay.prototype=new google.maps.OverlayView,Voxel.Maps.GoogleMapsOverlay.prototype.draw=function(){this.node||(this.node=this.template.get(0),this.node.addEventListener("click",e=>{this.marker.onClick&&this.marker.onClick(e,this.marker)}),this.getPanes().overlayImage.appendChild(this.node)),this.setPosition(this.latlng)},Voxel.Maps.GoogleMapsOverlay.prototype.remove=function(){this.node&&this.node.remove(),this.node=null},Voxel.Maps.GoogleMapsOverlay.prototype.getPosition=function(){return this.latlng},Voxel.Maps.GoogleMapsOverlay.prototype.getDraggable=function(){return!1},Voxel.Maps.GoogleMapsOverlay.prototype.getVisible=function(){return!0},Voxel.Maps.GoogleMapsOverlay.prototype.setPosition=function(e){this.latlng=e,this.node&&(this.latlng?(e=this.getProjection().fromLatLngToDivPixel(this.latlng),this.node.style.left=e.x+"px",this.node.style.top=e.y+"px",this.node.style.visibility="visible"):this.node.style.visibility="hidden")}},Voxel.Maps.Popup.prototype.init=function({map:e,position:t,content:o}){this.popup=new google.maps.InfoWindow,this.map=e,t&&this.setPosition(t),o&&this.setContent(o),google.maps.event.addListener(this.popup,"domready",()=>{this.popup.content.closest(".gm-style-iw-a").classList.add("ts-marker"),this.popup.content?.classList?.contains("empty-popup")&&this.popup.content.closest(".gm-style-iw-a").classList.add("ts-marker-empty")})},Voxel.Maps.Popup.prototype.setContent=function(e){this.popup.setContent(e)},Voxel.Maps.Popup.prototype.setPosition=function(e){this.popup.setPosition(e.getSourceObject())},Voxel.Maps.Popup.prototype.setMap=function(e){this.map=e},Voxel.Maps.Popup.prototype.show=function(){this.popup.open(this.map.getSourceObject())},Voxel.Maps.Popup.prototype.hide=function(){this.popup.close()},Voxel.Maps.Circle.prototype.init=function({map:e=null,center:t=null,radius:o=null,className:n=null}){this.overlay=new Voxel.Maps.CircleOverlay(t.getSourceObject(),o,e.getSourceObject(),n),this.circle=this.overlay.circle},Voxel.Maps.Circle.prototype.hide=function(){this.overlay.div_&&(this.overlay.div_.classList.add("hidden"),this.overlay.center_.classList.add("hidden"))},Voxel.Maps.Circle.prototype.show=function(){this.overlay.div_&&(this.overlay.div_.classList.remove("hidden"),this.overlay.center_.classList.remove("hidden"))},Voxel.Maps.Circle.prototype.setCenter=function(e){this.circle.setCenter(e.getSourceObject())},Voxel.Maps.Circle.prototype.setRadius=function(e){this.circle.setRadius(e)},Voxel.Maps.Circle.prototype.getBounds=function(){var e=this.circle.getBounds();return new Voxel.Maps.Bounds(new Voxel.Maps.LatLng(e.getSouthWest()),new Voxel.Maps.LatLng(e.getNorthEast()))},Voxel.Maps.SetupCircleOverlay=()=>{Voxel.Maps.CircleOverlay=function(e,t,o,n){this.circle=new google.maps.Circle({strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,clickable:!1,visible:!1,map:o,center:e,radius:t}),this.map_=o,this.div_=null,this.center_=null,this.className_=n,this.setMap(o)},Voxel.Maps.CircleOverlay.prototype=new google.maps.OverlayView,Voxel.Maps.CircleOverlay.prototype.onAdd=function(){var e=document.createElement("div"),t=(e.style.position="absolute",e.className=this.className_+" hidden",document.createElement("div")),t=(t.className="map-circle-inner",t.style.width="100%",t.style.height="100%",t.style.position="absolute",e.appendChild(t),document.createElement("div")),o=(t.className=this.className_+"-center hidden",t.style.position="absolute",this.div_=e,this.center_=t,this.getPanes());o.overlayLayer.appendChild(e),o.overlayLayer.appendChild(t)},Voxel.Maps.CircleOverlay.prototype.draw=function(){var e=this.getProjection(),t=this.circle.getBounds(),o=e.fromLatLngToDivPixel(t.getSouthWest()),n=e.fromLatLngToDivPixel(t.getNorthEast()),s=this.div_,s=(s.style.left=o.x+"px",s.style.top=n.y+"px",s.style.width=n.x-o.x+"px",s.style.height=o.y-n.y+"px",this.center_),o=e.fromLatLngToDivPixel(t.getCenter());s.style.left=o.x+"px",s.style.top=o.y+"px"},Voxel.Maps.CircleOverlay.prototype.onRemove=function(){this.div_.parentNode.removeChild(this.div_),this.div_=null,this.center_.parentNode.removeChild(this.center_),this.center_=null}},Voxel.Maps.GoogleMaps=function(){Voxel.Maps.SetupMarkerOverlay(),Voxel.Maps.SetupCircleOverlay(),Voxel.Maps.Loaded=!0,document.dispatchEvent(new Event("maps:loaded"))},jQuery(document).on("maps:loaded",()=>{jQuery(".ts-map.ts-map-autoload").each((e,t)=>{var o=jQuery(t).data("config"),t={el:t,zoom:3};o&&(o.zoom&&(t.zoom=o.zoom),o.minZoom&&(t.minZoom=o.minZoom),o.maxZoom&&(t.maxZoom=o.maxZoom),o.center)&&(t.center=new Voxel.Maps.LatLng(o.center.lat,o.center.lng));let n=new Voxel.Maps.Map(t);o.markers&&o.markers.forEach(e=>{new Voxel.Maps.Marker({map:n,position:new Voxel.Maps.LatLng(e.lat,e.lng),template:e.template})})})})});
