!function(e){"function"==typeof define&&define.amd?define("notifications",e):e()}(function(){"use strict";window.render_notifications=()=>{Array.from(document.querySelectorAll(".ts-notifications-wrapper")).forEach(o=>{if(!o.__vue_app__){let e=JSON.parse(o.dataset.config);var t=Vue.createApp({el:o,template:o.innerHTML,mixins:[Voxel.mixins.base],data(){return{active:!1,screen:"main",list:null,hasMore:!1,loading:!0,loadingMore:!1,page:1}},methods:{open(){null===this.list&&(this.list=[],this.$refs.indicator?.classList.add("hidden"),this.getList()),this.active=!0},getList(){this.loadingMore=!0,jQuery.get(Voxel_Config.ajax_url+"&action=notifications.list",{pg:this.page}).always(e=>{e.success?(this.list.push(...e.list),this.hasMore=e.has_more):Voxel.alert(e.message||Voxel_Config.l10n.ajaxError,"error"),this.loading=!1,this.loadingMore=!1})},loadMore(){this.page++,this.getList()},clearAll(){confirm(e.l10n.confirmClear)&&jQuery.get(Voxel_Config.ajax_url+"&action=notifications.clear_all").always(e=>{e.success?this.list=[]:Voxel.alert(e.message||Voxel_Config.l10n.ajaxError,"error")})},openItem(o){o._loading=!0,jQuery.get(Voxel_Config.ajax_url+"&action=notifications.open",{item_id:o.id}).always(e=>{e.success?(o.seen=!0,e.redirect_to&&(window.location.href=e.redirect_to)):Voxel.alert(e.message||Voxel_Config.l10n.ajaxError,"error"),o._loading=!1})}}});t.component("form-popup",Voxel.components.popup),t.component("form-group",Voxel.components.formGroup),t.mount(o)}})},window.render_notifications(),jQuery(document).on("voxel:markup-update",window.render_notifications),window.render_popup_messages=()=>{Array.from(document.querySelectorAll(".ts-popup-messages")).forEach(o=>{if(!o.__vue_app__){let e=JSON.parse(o.dataset.config);var t=Vue.createApp({el:o,template:o.innerHTML,mixins:[Voxel.mixins.base],data(){return{active:!1,chats:{list:null,hasMore:!1,loading:!0,loadingMore:!1,page:1}}},methods:{open(){this.active=!0,null===this.chats.list&&(this.chats.list=[],this.$refs.indicator?.classList.add("hidden"),this.getChats())},getChats(){this.chats.loadingMore=!0,jQuery.get(Voxel_Config.ajax_url+"&action=inbox.list_chats",{pg:this.chats.page,_wpnonce:e.nonce}).always(e=>{e.success?(this.chats.list.push(...e.list),this.chats.hasMore=e.has_more):Voxel.alert(e.message||Voxel_Config.l10n.ajaxError,"error"),this.chats.loading=!1,this.chats.loadingMore=!1})},loadMoreChats(){this.chats.page++,this.getChats()}}});t.component("form-popup",Voxel.components.popup),t.mount(o)}})},window.render_popup_messages(),jQuery(document).on("voxel:markup-update",window.render_popup_messages)});
